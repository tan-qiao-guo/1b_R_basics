<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>.white[.large[1.R的基础知识]]</title>
    <meta charset="utf-8" />
    <meta name="author" content="" />
    <script src="libs/header-attrs-2.25/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link rel="stylesheet" href="zh-CN.css" type="text/css" />
    <link rel="stylesheet" href="extra.css" type="text/css" />
    <link rel="stylesheet" href="footer-header.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# .white[.large[<code>1.R</code>的基础知识]]
]
.author[
### 
]

---


layout: true
  
&lt;div class="my-footer"&gt;&lt;span&gt;Qiao-Guo Tan/CEE/XMU | tanqg@xmu.edu.cn | 2025-Feb-20   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;/span&gt;&lt;/div&gt; 

---
## 目录
#### 1. R可当计算器用
#### 2. 变量命名与赋值
#### 3. 数据类型与强制转化
#### 4. 缺失值和无穷大
#### 5. 向量生成与运算
#### 6. 矩阵生成
#### 7. 数据框生成与操作
#### 8. 读取与保存数据框
#### 9. 作图与保存


---

## 1. R可当计算器用


```r
(1 + 2 * 4)/3 - 1.3  
```

```
# [1] 1.7
```

```r
100^0.5 #100的0.5次方根
```

```
# [1] 10
```

```r
log(2) #注意这是自然对数，与excel里的用法不一样
```

```
# [1] 0.6931472
```

```r
log10(2) #这才是以10为底的对数
```

```
# [1] 0.30103
```


---


```r
exp(1) #e是自然对数的底，e=2.718..., exp(1) = e^1；用于指数函数
```

```
## [1] 2.718282
```

```r
sin(pi/2) # pi = 3.14159...圆周率
```

```
## [1] 1
```

```r
6.22e23 #科学计数法，6.22*10^23，注意这里e不是自然对数的底
```

```
## [1] 6.22e+23
```

```r
abs(-10) #绝对值
```

```
## [1] 10
```

???
```r 
options(digits=22)  
pi

```

---

### 取整：`round, floor, ceiling, trunc`

.pull-left[
`round()`函数取整原则：**四舍六入五成双**

```r
round(2.3)
```

```
## [1] 2
```

```r
round(2.6)
```

```
## [1] 3
```

```r
round(2.5)
```

```
## [1] 2
```

```r
round(3.5)
```

```
## [1] 4
```
]

--
.pull-right[


```r
floor(2.6) #向下取整
```

```
## [1] 2
```

```r
ceiling(2.3) #向上取整
```

```
## [1] 3
```

```r
trunc(2.3)#取整数部分，对于正数，等价于floor
```

```
## [1] 2
```

```r
trunc(-2.6) #取整数部分，对于负数，等价于ceiling
```

```
## [1] -2
```
]

---

### 保留有效数字：`round, signif`

原则：**四舍六入五成双**

```r
round(pi, 2) #保留2位小数
```

```
## [1] 3.14
```

```r
round(pi, 3) #保留3位小数
```

```
## [1] 3.142
```

```r
signif(pi,2) #保留2位有效数字
```

```
## [1] 3.1
```

```r
signif(pi,3) #保留3位有效数字
```

```
## [1] 3.14
```



---

### 常用运算符

符号                 | 含义
---------------------|-------------
+, -, *, /, ˆ        | 算术运算符：加、减、乘、除、乘方
%/%, %%              | 商、余数
\&gt;, =, &lt;, &lt;=, ==, != |关系运算符：大于等于、小于、小于等于、等于、不等于
 !, &amp;, &amp;#124;        |逻辑运算符：非、与、或
~                    |前者是后者的函数
&lt;-, -&gt;               |赋值符号 (可读作“得到”)
$                    |列表索引
:                    |创建序列


---

### 逻辑运算  

.pull-left[

```r
5 &gt; 3 # 大于
```

```
## [1] TRUE
```

```r
5 == 3 #等于
```

```
## [1] FALSE
```

```r
1:5 != 3 #不等于
```

```
## [1]  TRUE  TRUE FALSE  TRUE  TRUE
```
]

.pull-right[

```r
1:5 &gt; 2 &amp; 1:5 &lt;5 # AND/与
```

```
## [1] FALSE FALSE  TRUE  TRUE FALSE
```

```r
1:5 &lt;= 2 | 1:5 &gt;=4 # OR/或
```

```
## [1]  TRUE  TRUE FALSE  TRUE  TRUE
```
]

&gt;注：`1：5`的是指包含“1，2，3，4，5”这5个自然数的向量

---

##  2. 变量赋值与命名

在R语言里，用符号".red[**`&lt;-`**]"给变量赋值。它的功能和"**`=`**"虽几乎相同，但在有的场合有区别。
.pull-left[

```r
x1 = 12
x1
```

```
## [1] 12
```

```r
x2 &lt;- 23
x2
```

```
## [1] 23
```

```r
y &lt;- x1 + x2
y
```

```
## [1] 35
```

```r
x1 + x2 -&gt; z 
z
```

```
## [1] 35
```
]
.pull-right[

```r
data.frame(x = 1:3, y = 4:6)
```

```
##   x y
## 1 1 4
## 2 2 5
## 3 3 6
```

```r
data.frame(x &lt;- 1:3, y &lt;- 4:6)
```

```
##   x....1.3 y....4.6
## 1        1        4
## 2        2        5
## 3        3        6
```
]

---

##  变量命名规则  


.red[.large[
* 变量名只能是字母、数字、点（`.`）、下划线（`_`）的组合
]]

--

.large[
* 只能以字母或点开头；不能以数字、下划线开头
]

--

.red[.large[
* 对字母大小写敏感，`a`和`A`是不同的变量
]]

--

.large[
* 变量名不能含有空格：`x_1`, `x.1`都可以，但`x 1`不可以；推荐`x_1`形式的命名，理由是方便阅读，方便记忆
]

---

##  3. 数据类型  

.pull-left[
数据类型 | 含义
---------|-------------
integer  | 整数
numeric  | 实数
character| 字符
logical  | 逻辑值(`TRUE`或`FALSE`)

 
]

.pull-right[

* **用`class()`查看数据类型 **

```r
class(as.integer(1.2)) #将1.2转化为整数,并查看其类型
```

```
## [1] "integer"
```

```r
class(pi) # pi = 3.1415......
```

```
## [1] "numeric"
```

```r
class("Xiamen")
```

```
## [1] "character"
```

```r
class(c(TRUE,FALSE))
```

```
## [1] "logical"
```
]

---

##  常用的数据结构

数据结构  |    说明
----------|------------------------------------------
vector    | 向量，元素可以是数值、字符串、逻辑值
factor    | 因子，水平，是离散的，以整数vector形式储存，映射到字符串上
matrix    | 矩阵，所有元素的类型(numeric, character等)需一致
data frame| 数据框，和matrix类似，但每列的类型可以不一致
list      | 清单，与vector类似，但每个元素的类型可以不一致，且可以是任何数据类型（例如numeric,data frame, list...)


---

## 数据类型强制转化 



.pull-left[
* 强制转化为数值`as.numeric()`

```r
t_1 &lt;- c("1", "2", "3.4") #字符，无法进行计算
t_1
```

```
## [1] "1"   "2"   "3.4"
```

```r
class(t_1)
```

```
## [1] "character"
```

```r
t_2 &lt;- as.numeric(t_1) #转化为数值，就可以计算了
t_2
```

```
## [1] 1.0 2.0 3.4
```

```r
class(t_2)
```

```
## [1] "numeric"
```
]

--
.pull-right[
* 强制转化为因子`as.factor()`

```r
t_3 &lt;- as.factor(t_2) #数值转化为因子，非常有用的功能，以后详述
t_3
```

```
## [1] 1   2   3.4
## Levels: 1 2 3.4
```

```r
class(t_3)
```

```
## [1] "factor"
```
]


---

# 4. 缺失值（`NA`）和无穷大（`Inf`）

实验数据经常会有缺失值，缺失值的处理对于数据分析非常重要。
.pull-left[
* 用`is.na()`判断是否为缺失值

```r
v0 &lt;- c(1, 3, 4, NA) #第4个数缺失  
v0
```

```
## [1]  1  3  4 NA
```

```r
is.na(v0) #判断是否有缺失值
```

```
## [1] FALSE FALSE FALSE  TRUE
```

```r
v0[is.na(v0)] &lt;- 0 #将缺失值替换为0
v0
```

```
## [1] 1 3 4 0
```
]

--

.pull-right[
* 用`is.infinite()`判断是否为无穷大

```r
logv0 &lt;- log(v0) #对数据进行自然对数转化，产生了负无穷大值（-Inf）
logv0
```

```
## [1] 0.000000 1.098612 1.386294     -Inf
```

```r
is.infinite(logv0) # 检查是否有无穷大，包括Inf和-Inf
```

```
## [1] FALSE FALSE FALSE  TRUE
```

```r
logv0[is.infinite(logv0)] &lt;- NA #将无穷大替换为缺失值NA
logv0
```

```
## [1] 0.000000 1.098612 1.386294       NA
```
]

---

## 5. 向量（vector）

**用函数`c( )`生成向量**  

&gt;"c"的含义:
&gt;1. combine  
&gt;2. concatenate [kɒn'kætɪneɪt] vt.把 （一系列事件、事情等）联系起来  

--

.pull-left[
* **数值向量**  


```r
v1 &lt;- c(1.4, 3, 10.9, -7)
v1
```

```
## [1]  1.4  3.0 10.9 -7.0
```

* **字符向量**  


```r
v2 &lt;- c("apple","organge","banana")
v2
```

```
## [1] "apple"   "organge" "banana"
```
]

--
.pull-right[

* **逻辑值向量**  


```r
v3 &lt;- c(TRUE,FALSE,TRUE,FALSE)
v3
```

```
## [1]  TRUE FALSE  TRUE FALSE
```
]



---

**用 `seq()`生成等差序列**  


```r
seq(from = 10, to = 100, by = 10) 
```

```
##  [1]  10  20  30  40  50  60  70  80  90 100
```
--
from是第一个值，to是最后一个值，by是相邻两个数的间隔值。  
可以简略成(默认第1个数赋给`from`，第2个数赋给`to`，第3个数赋给`by`) :

```r
seq(10, 100, 10)
```

```
##  [1]  10  20  30  40  50  60  70  80  90 100
```
--

**怎么使用`seq()`函数？--查看帮助信息。**

执行代码.large[`?seq`]， 你会在Help栏看到如下信息:

&gt; Usage  
&gt;seq(...)  
&gt;Default S3 method:  
&gt;seq(from = 1, to = 1, by = ((to - from)/(length.out - 1)),
&gt;    length.out = NULL, along.with = NULL, ...)  

--
  
耐心读一读，你可以看懂。  

---

**读懂之后，你还可以这么使用`seq()`：**


```r
seq(10, 100, length.out = 19)
```

```
##  [1]  10  15  20  25  30  35  40  45  50  55  60  65  70  75  80  85  90  95 100
```
`length.out`是数列的长度


```r
v2 &lt;- seq(10, 100, length.out = 19)
v2[12]
```

```
## [1] 65
```

---

**用`:`符号生成连续自然数序列**


```r
1:10
```

```
##  [1]  1  2  3  4  5  6  7  8  9 10
```

```r
v3 &lt;- 20:30
v3
```

```
##  [1] 20 21 22 23 24 25 26 27 28 29 30
```

---

**用`rep()`重复元素，生成向量**
.pull-left[

```r
rep(8, 5)
```

```
## [1] 8 8 8 8 8
```

```r
rep("ha", 6)
```

```
## [1] "ha" "ha" "ha" "ha" "ha" "ha"
```
]

--

.pull-right[

```r
rep(1:3, 2)
```

```
## [1] 1 2 3 1 2 3
```

```r
rep(1:3, each = 3)
```

```
## [1] 1 1 1 2 2 2 3 3 3
```

```r
rep(1:3, each = 3, times=2)
```

```
##  [1] 1 1 1 2 2 2 3 3 3 1 1 1 2 2 2 3 3 3
```
]

这个功能在自动填充数据框时非常有用，例如，填充treatment，replicate编号。

---

### 向量信息提取与运算  

```r
v1 &lt;- c(1.4, 3, 10.9, -7)
v1[3] # 引用第3个元素
```

```
## [1] 10.9
```

```r
v1 + 10 # 每个元素均加10
```

```
## [1] 11.4 13.0 20.9  3.0
```

```r
v1 * 10 # 每个元素均乘以10
```

```
## [1]  14  30 109 -70
```

```r
v1^2 #每个元素均求平方
```

```
## [1]   1.96   9.00 118.81  49.00
```


---

### 针对向量的统计运算

.pull-left[

```r
v4 &lt;- seq(60, 100, 5)
v4
```

```
## [1]  60  65  70  75  80  85  90  95 100
```

```r
summary(v4) 
```

```
##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##      60      70      80      80      90     100
```

```r
mean(v4) #算术平均值
```

```
## [1] 80
```

```r
median(v4) #中位数
```

```
## [1] 80
```
]

--

.pull-right[

```r
sd(v4) # 标准差
```

```
## [1] 13.69306
```

```r
min(v4) # 最小值
```

```
## [1] 60
```

```r
max(v4) # 最大值
```

```
## [1] 100
```

```r
range(v4) #范围：最小值～最大值
```

```
## [1]  60 100
```
]


---

## 6. 矩阵（matrix）

**用`matrix()`函数生成一个矩阵**


```r
m1 &lt;- matrix(1:18, nrow=3, ncol=6)
m1
```

```
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    4    7   10   13   16
## [2,]    2    5    8   11   14   17
## [3,]    3    6    9   12   15   18
```
--
默认按列排元素，可用`byrow`更改为按行排

```r
m2 &lt;- matrix(1:18, nrow=3, ncol=6, byrow=T)
m2
```

```
##      [,1] [,2] [,3] [,4] [,5] [,6]
## [1,]    1    2    3    4    5    6
## [2,]    7    8    9   10   11   12
## [3,]   13   14   15   16   17   18
```

---

## 7. 数据框（data frame）

**用`data.frame()`函数生成一个数据框**

数据框储存以下信息：学生姓名、性别、考试分数

```r
student &lt;- c("Tom", "Jack", "Mingming", "Alice", "Feifei")
sex &lt;- c("Male", "Male", "Male", "Female", "Female")
score &lt;- c(83, 72, 80, 92, 95)

data.frame(student, sex, score)
```

```
##    student    sex score
## 1      Tom   Male    83
## 2     Jack   Male    72
## 3 Mingming   Male    80
## 4    Alice Female    92
## 5   Feifei Female    95
```

--

可将该数据框储存于变量**`d1`**中，也可以说给数据框取个名字叫**`d1`**

```r
d1 &lt;- data.frame(student, sex, score)
```


---

### 引用`data.frame`中的信息  

引用**`d1`**数据框的**`student`**列有两种方法，一种是用名称，一种是用编号：

```r
d1$student 
```

```
## [1] "Tom"      "Jack"     "Mingming" "Alice"    "Feifei"
```

```r
d1[ , 1] #逗号前是行号，逗号后是列号
```

```
## [1] "Tom"      "Jack"     "Mingming" "Alice"    "Feifei"
```

--
引用**`d1`**数据框第2个学生的成绩有两种方法，一种是用名称，一种是用编号:

```r
d1$score[2]
```

```
## [1] 72
```

```r
d1[2, 3] 
```

```
## [1] 72
```

---

### 查看base R自带的数据


```r
data() #用此函数查看R自带的数据，以下是节选。
```
可以用这些数据来测试、交流你的统计、绘图代码。

数据名称 |简介
--------------|--------------------------
BOD           |Biochemical Oxygen Demand  
ChickWeight   |Weight versus age of chicks on different  
ToothGrowth   |The Effect of Vitamin C on Tooth Growth in Guinea Pigs
co2           |Mauna Loa Atmospheric CO2 Concentration
iris          |Edgar Anderson's Iris Data
mtcars        |Motor Trend Car Road Tests
npk           |Classical N, P, K Factorial Experiment
precip        |Annual Precipitation in US Cities
pressure      |Vapor Pressure of Mercury as a Function of Temperature
rivers        |Lengths of Major North American Rivers


---
  
### 查看数据框的常用命令
  
* 查看数据**`iris`**表头（默认前6行，可更改）  


```r
head(iris )
```

```
##   Sepal.Length Sepal.Width Petal.Length Petal.Width Species
## 1          5.1         3.5          1.4         0.2  setosa
## 2          4.9         3.0          1.4         0.2  setosa
## 3          4.7         3.2          1.3         0.2  setosa
## 4          4.6         3.1          1.5         0.2  setosa
## 5          5.0         3.6          1.4         0.2  setosa
## 6          5.4         3.9          1.7         0.4  setosa
```

--
  
* 查看表尾（默认最后6行，可更改，此处改为4行）  


```r
tail(iris, 4)
```

```
##     Sepal.Length Sepal.Width Petal.Length Petal.Width   Species
## 147          6.3         2.5          5.0         1.9 virginica
## 148          6.5         3.0          5.2         2.0 virginica
## 149          6.2         3.4          5.4         2.3 virginica
## 150          5.9         3.0          5.1         1.8 virginica
```

---

* 查看数据框有哪些变量   


```r
names(iris) 
```

```
## [1] "Sepal.Length" "Sepal.Width"  "Petal.Length" "Petal.Width"  "Species"
```
以上结果显示5个变量的名称，**每1列是1个变量**。

--

* 查看数据框的尺寸（dimension），即**行数**和**列数**

```r
dim(iris) 
```

```
## [1] 150   5
```
结果显示150行，5列。

--

`length()`显示数据框的列数，即变量数；显示vector的长度，即元素数。

```r
length(iris) #5列
```

```
## [1] 5
```

```r
length(iris$Species) #150行
```

```
## [1] 150
```



---

### 查看数据框的其他性质  

* **查看数据框的结构**

```r
str(iris)    
```

```
## 'data.frame':	150 obs. of  5 variables:
##  $ Sepal.Length: num  5.1 4.9 4.7 4.6 5 5.4 4.6 5 4.4 4.9 ...
##  $ Sepal.Width : num  3.5 3 3.2 3.1 3.6 3.9 3.4 3.4 2.9 3.1 ...
##  $ Petal.Length: num  1.4 1.4 1.3 1.5 1.4 1.7 1.4 1.5 1.4 1.5 ...
##  $ Petal.Width : num  0.2 0.2 0.2 0.2 0.2 0.4 0.3 0.2 0.2 0.1 ...
##  $ Species     : Factor w/ 3 levels "setosa","versicolor",..: 1 1 1 1 1 1 1 1 1 1 ...
```
前4列均为**`numeric`**，最后一列为**`factor`**  


---

* **查看数据框的概要**


```r
summary(iris)
```

```
##   Sepal.Length    Sepal.Width     Petal.Length    Petal.Width   
##  Min.   :4.300   Min.   :2.000   Min.   :1.000   Min.   :0.100  
##  1st Qu.:5.100   1st Qu.:2.800   1st Qu.:1.600   1st Qu.:0.300  
##  Median :5.800   Median :3.000   Median :4.350   Median :1.300  
##  Mean   :5.843   Mean   :3.057   Mean   :3.758   Mean   :1.199  
##  3rd Qu.:6.400   3rd Qu.:3.300   3rd Qu.:5.100   3rd Qu.:1.800  
##  Max.   :7.900   Max.   :4.400   Max.   :6.900   Max.   :2.500  
##        Species  
##  setosa    :50  
##  versicolor:50  
##  virginica :50  
##                 
##                 
## 
```
包含了每列的最小值、25%分位数、中位值、均值、75%分位数、最大值

--

* **查看`iris`这个对象（object）的类型**  


```r
class(iris) 
```

```
## [1] "data.frame"
```
当然是**data.frame**类型。

---

### 合并数据框


```r
d1
```

```
##    student    sex score
## 1      Tom   Male    83
## 2     Jack   Male    72
## 3 Mingming   Male    80
## 4    Alice Female    92
## 5   Feifei Female    95
```

--


```r
d2 &lt;- data.frame(age = c(20, 19, 20, 21, 19))
d2
```

```
##   age
## 1  20
## 2  19
## 3  20
## 4  21
## 5  19
```

---

.pull-left[
* 合并列（**`column binding`**）

```r
cbind(d1, d2) 
```

```
##    student    sex score age
## 1      Tom   Male    83  20
## 2     Jack   Male    72  19
## 3 Mingming   Male    80  20
## 4    Alice Female    92  21
## 5   Feifei Female    95  19
```
]

--

.pull-right[
* 合并行（**`row binding`**）

```r
rbind(d1, d1)
```

```
##     student    sex score
## 1       Tom   Male    83
## 2      Jack   Male    72
## 3  Mingming   Male    80
## 4     Alice Female    92
## 5    Feifei Female    95
## 6       Tom   Male    83
## 7      Jack   Male    72
## 8  Mingming   Male    80
## 9     Alice Female    92
## 10   Feifei Female    95
```
]


---

## 8. 读入数据

四种方法：

代码 | 说明
-----|----------------------------
`d1 &lt;- read.table("clipboard", head = T)` | 从剪贴板（ctrl+C）直接读取，适合于小数据框的快速操作
`d2 &lt;- read.csv(file.choose())` | 弹出对话框，点击鼠标选取文件，读取`csv`格式的数据
`d3 &lt;- read.csv("你的文件名.csv")` |从工作目录下直接读取`csv`格式的数据
`d4 &lt;- read_excel("你的文件名.xlsx", sheet = 1)` | 直接读取`xlsx`文件中某个sheet（此处为sheet1）中的数据，需先加载`readxl`程序包


---

##  输出数据

`co2`是R自带的时间序列数据，此处将其转化为`data.frame`，用**`write.csv()`**函数将数据储存于名为“CO2_data.csv”的文件中。你可在工作文件夹下找到该文件。 

```r
d_CO2 &lt;- data.frame(time = time(co2), CO2 = co2) 

write.csv(d_CO2, "CO2_data.csv")
```


---
## 准确分享数据

运行`dput()`，数据转化为纯文本格式输出，便于准确与他人分享

```r
dput(d_CO2)
```

```
## structure(list(time = structure(c(1959, 1959.08333333334, 1959.16666666668, 
## 1959.25000000002, 1959.33333333336, 1959.4166666667, 1959.50000000004, 
## 1959.58333333338, 1959.66666666672, 1959.75000000006, 1959.8333333334, 
## 1959.91666666675, 1960, 1960.08333333343, 1960.16666666677, 1960.25000000011, 
## 1960.33333333345, 1960.41666666679, 1960.50000000013, 1960.58333333347, 
## 1960.66666666681, 1960.75000000015, 1960.83333333349, 1960.91666666683, 
## 1961, 1961.08333333351, 1961.16666666685, 1961.25000000019, 1961.33333333353, 
## 1961.41666666687, 1961.50000000021, 1961.58333333355, 1961.6666666669, 
## 1961.75000000024, 1961.83333333358, 1961.91666666692, 1962, 1962.0833333336, 
## 1962.16666666694, 1962.25000000028, 1962.33333333362, 1962.41666666696, 
## 1962.5000000003, 1962.58333333364, 1962.66666666698, 1962.75000000032, 
## 1962.83333333366, 1962.916666667, 1963, 1963.08333333368, 1963.16666666702, 
## 1963.25000000036, 1963.3333333337, 1963.41666666704, 1963.50000000039, 
## 1963.58333333373, 1963.66666666707, 1963.75000000041, 1963.83333333375, 
## 1963.91666666709, 1964, 1964.08333333377, 1964.16666666711, 1964.25000000045, 
## 1964.33333333379, 1964.41666666713, 1964.50000000047, 1964.58333333381, 
## 1964.66666666715, 1964.75000000049, 1964.83333333383, 1964.91666666717, 
## 1965, 1965.08333333385, 1965.1666666672, 1965.25000000054, 1965.33333333388, 
## 1965.41666666722, 1965.50000000056, 1965.5833333339, 1965.66666666724, 
## 1965.75000000058, 1965.83333333392, 1965.91666666726, 1966, 1966.08333333394, 
## 1966.16666666728, 1966.25000000062, 1966.33333333396, 1966.4166666673, 
## 1966.50000000064, 1966.58333333398, 1966.66666666732, 1966.75000000066, 
## 1966.833333334, 1966.91666666734, 1967, 1967.08333333403, 1967.16666666737, 
## 1967.25000000071, 1967.33333333405, 1967.41666666739, 1967.50000000073, 
## 1967.58333333407, 1967.66666666741, 1967.75000000075, 1967.83333333409, 
## 1967.91666666743, 1968, 1968.08333333411, 1968.16666666745, 1968.25000000079, 
## 1968.33333333413, 1968.41666666747, 1968.50000000081, 1968.58333333415, 
## 1968.66666666749, 1968.75000000084, 1968.83333333418, 1968.91666666752, 
## 1969, 1969.0833333342, 1969.16666666754, 1969.25000000088, 1969.33333333422, 
## 1969.41666666756, 1969.5000000009, 1969.58333333424, 1969.66666666758, 
## 1969.75000000092, 1969.83333333426, 1969.9166666676, 1970, 1970.08333333428, 
## 1970.16666666762, 1970.25000000096, 1970.3333333343, 1970.41666666764, 
## 1970.50000000098, 1970.58333333433, 1970.66666666767, 1970.75000000101, 
## 1970.83333333435, 1970.91666666769, 1971, 1971.08333333437, 1971.16666666771, 
## 1971.25000000105, 1971.33333333439, 1971.41666666773, 1971.50000000107, 
## 1971.58333333441, 1971.66666666775, 1971.75000000109, 1971.83333333443, 
## 1971.91666666777, 1972, 1972.08333333445, 1972.16666666779, 1972.25000000113, 
## 1972.33333333448, 1972.41666666782, 1972.50000000116, 1972.5833333345, 
## 1972.66666666784, 1972.75000000118, 1972.83333333452, 1972.91666666786, 
## 1973, 1973.08333333454, 1973.16666666788, 1973.25000000122, 1973.33333333456, 
## 1973.4166666679, 1973.50000000124, 1973.58333333458, 1973.66666666792, 
## 1973.75000000126, 1973.8333333346, 1973.91666666794, 1974, 1974.08333333463, 
## 1974.16666666797, 1974.25000000131, 1974.33333333465, 1974.41666666799, 
## 1974.50000000133, 1974.58333333467, 1974.66666666801, 1974.75000000135, 
## 1974.83333333469, 1974.91666666803, 1975, 1975.08333333471, 1975.16666666805, 
## 1975.25000000139, 1975.33333333473, 1975.41666666807, 1975.50000000141, 
## 1975.58333333475, 1975.66666666809, 1975.75000000143, 1975.83333333478, 
## 1975.91666666812, 1976, 1976.0833333348, 1976.16666666814, 1976.25000000148, 
## 1976.33333333482, 1976.41666666816, 1976.5000000015, 1976.58333333484, 
## 1976.66666666818, 1976.75000000152, 1976.83333333486, 1976.9166666682, 
## 1977, 1977.08333333488, 1977.16666666822, 1977.25000000156, 1977.3333333349, 
## 1977.41666666824, 1977.50000000158, 1977.58333333493, 1977.66666666827, 
## 1977.75000000161, 1977.83333333495, 1977.91666666829, 1978, 1978.08333333497, 
## 1978.16666666831, 1978.25000000165, 1978.33333333499, 1978.41666666833, 
## 1978.50000000167, 1978.58333333501, 1978.66666666835, 1978.75000000169, 
## 1978.83333333503, 1978.91666666837, 1979, 1979.08333333505, 1979.16666666839, 
## 1979.25000000173, 1979.33333333507, 1979.41666666842, 1979.50000000176, 
## 1979.5833333351, 1979.66666666844, 1979.75000000178, 1979.83333333512, 
## 1979.91666666846, 1980, 1980.08333333514, 1980.16666666848, 1980.25000000182, 
## 1980.33333333516, 1980.4166666685, 1980.50000000184, 1980.58333333518, 
## 1980.66666666852, 1980.75000000186, 1980.8333333352, 1980.91666666854, 
## 1981, 1981.08333333522, 1981.16666666857, 1981.25000000191, 1981.33333333525, 
## 1981.41666666859, 1981.50000000193, 1981.58333333527, 1981.66666666861, 
## 1981.75000000195, 1981.83333333529, 1981.91666666863, 1982, 1982.08333333531, 
## 1982.16666666865, 1982.25000000199, 1982.33333333533, 1982.41666666867, 
## 1982.50000000201, 1982.58333333535, 1982.66666666869, 1982.75000000203, 
## 1982.83333333537, 1982.91666666872, 1983, 1983.0833333354, 1983.16666666874, 
## 1983.25000000208, 1983.33333333542, 1983.41666666876, 1983.5000000021, 
## 1983.58333333544, 1983.66666666878, 1983.75000000212, 1983.83333333546, 
## 1983.9166666688, 1984, 1984.08333333548, 1984.16666666882, 1984.25000000216, 
## 1984.3333333355, 1984.41666666884, 1984.50000000218, 1984.58333333552, 
## 1984.66666666887, 1984.75000000221, 1984.83333333555, 1984.91666666889, 
## 1985, 1985.08333333557, 1985.16666666891, 1985.25000000225, 1985.33333333559, 
## 1985.41666666893, 1985.50000000227, 1985.58333333561, 1985.66666666895, 
## 1985.75000000229, 1985.83333333563, 1985.91666666897, 1986, 1986.08333333565, 
## 1986.16666666899, 1986.25000000233, 1986.33333333567, 1986.41666666902, 
## 1986.50000000236, 1986.5833333357, 1986.66666666904, 1986.75000000238, 
## 1986.83333333572, 1986.91666666906, 1987, 1987.08333333574, 1987.16666666908, 
## 1987.25000000242, 1987.33333333576, 1987.4166666691, 1987.50000000244, 
## 1987.58333333578, 1987.66666666912, 1987.75000000246, 1987.8333333358, 
## 1987.91666666914, 1988, 1988.08333333582, 1988.16666666916, 1988.25000000251, 
## 1988.33333333585, 1988.41666666919, 1988.50000000253, 1988.58333333587, 
## 1988.66666666921, 1988.75000000255, 1988.83333333589, 1988.91666666923, 
## 1989, 1989.08333333591, 1989.16666666925, 1989.25000000259, 1989.33333333593, 
## 1989.41666666927, 1989.50000000261, 1989.58333333595, 1989.66666666929, 
## 1989.75000000263, 1989.83333333597, 1989.91666666931, 1990, 1990.083333336, 
## 1990.16666666934, 1990.25000000268, 1990.33333333602, 1990.41666666936, 
## 1990.5000000027, 1990.58333333604, 1990.66666666938, 1990.75000000272, 
## 1990.83333333606, 1990.9166666694, 1991, 1991.08333333608, 1991.16666666942, 
## 1991.25000000276, 1991.3333333361, 1991.41666666944, 1991.50000000278, 
## 1991.58333333612, 1991.66666666946, 1991.7500000028, 1991.83333333615, 
## 1991.91666666949, 1992, 1992.08333333617, 1992.16666666951, 1992.25000000285, 
## 1992.33333333619, 1992.41666666953, 1992.50000000287, 1992.58333333621, 
## 1992.66666666955, 1992.75000000289, 1992.83333333623, 1992.91666666957, 
## 1993, 1993.08333333625, 1993.16666666959, 1993.25000000293, 1993.33333333627, 
## 1993.41666666961, 1993.50000000296, 1993.5833333363, 1993.66666666964, 
## 1993.75000000298, 1993.83333333632, 1993.91666666966, 1994, 1994.08333333634, 
## 1994.16666666968, 1994.25000000302, 1994.33333333636, 1994.4166666697, 
## 1994.50000000304, 1994.58333333638, 1994.66666666972, 1994.75000000306, 
## 1994.8333333364, 1994.91666666974, 1995, 1995.08333333642, 1995.16666666976, 
## 1995.2500000031, 1995.33333333645, 1995.41666666979, 1995.50000000313, 
## 1995.58333333647, 1995.66666666981, 1995.75000000315, 1995.83333333649, 
## 1995.91666666983, 1996, 1996.08333333651, 1996.16666666985, 1996.25000000319, 
## 1996.33333333653, 1996.41666666987, 1996.50000000321, 1996.58333333655, 
## 1996.66666666989, 1996.75000000323, 1996.83333333657, 1996.91666666991, 
## 1997, 1997.0833333366, 1997.16666666994, 1997.25000000328, 1997.33333333662, 
## 1997.41666666996, 1997.5000000033, 1997.58333333664, 1997.66666666998, 
## 1997.75000000332, 1997.83333333666, 1997.91666667), tsp = c(1959, 
## 1997.91666667, 12), class = "ts"), CO2 = structure(c(315.42, 
## 316.31, 316.5, 317.56, 318.13, 318, 316.39, 314.65, 313.68, 313.18, 
## 314.66, 315.43, 316.27, 316.81, 317.42, 318.87, 319.87, 319.43, 
## 318.01, 315.74, 314, 313.68, 314.84, 316.03, 316.73, 317.54, 
## 318.38, 319.31, 320.42, 319.61, 318.42, 316.63, 314.83, 315.16, 
## 315.94, 316.85, 317.78, 318.4, 319.53, 320.42, 320.85, 320.45, 
## 319.45, 317.25, 316.11, 315.27, 316.53, 317.53, 318.58, 318.92, 
## 319.7, 321.22, 322.08, 321.31, 319.58, 317.61, 316.05, 315.83, 
## 316.91, 318.2, 319.41, 320.07, 320.74, 321.4, 322.06, 321.73, 
## 320.27, 318.54, 316.54, 316.71, 317.53, 318.55, 319.27, 320.28, 
## 320.73, 321.97, 322, 321.71, 321.05, 318.71, 317.66, 317.14, 
## 318.7, 319.25, 320.46, 321.43, 322.23, 323.54, 323.91, 323.59, 
## 322.24, 320.2, 318.48, 317.94, 319.63, 320.87, 322.17, 322.34, 
## 322.88, 324.25, 324.83, 323.93, 322.38, 320.76, 319.1, 319.24, 
## 320.56, 321.8, 322.4, 322.99, 323.73, 324.86, 325.4, 325.2, 323.98, 
## 321.95, 320.18, 320.09, 321.16, 322.74, 323.83, 324.26, 325.47, 
## 326.5, 327.21, 326.54, 325.72, 323.5, 322.22, 321.62, 322.69, 
## 323.95, 324.89, 325.82, 326.77, 327.97, 327.91, 327.5, 326.18, 
## 324.53, 322.93, 322.9, 323.85, 324.96, 326.01, 326.51, 327.01, 
## 327.62, 328.76, 328.4, 327.2, 325.27, 323.2, 323.4, 324.63, 325.85, 
## 326.6, 327.47, 327.58, 329.56, 329.9, 328.92, 327.88, 326.16, 
## 324.68, 325.04, 326.34, 327.39, 328.37, 329.4, 330.14, 331.33, 
## 332.31, 331.9, 330.7, 329.15, 327.35, 327.02, 327.99, 328.48, 
## 329.18, 330.55, 331.32, 332.48, 332.92, 332.08, 331.01, 329.23, 
## 327.27, 327.21, 328.29, 329.41, 330.23, 331.25, 331.87, 333.14, 
## 333.8, 333.43, 331.73, 329.9, 328.4, 328.17, 329.32, 330.59, 
## 331.58, 332.39, 333.33, 334.41, 334.71, 334.17, 332.89, 330.77, 
## 329.14, 328.78, 330.14, 331.52, 332.75, 333.24, 334.53, 335.9, 
## 336.57, 336.1, 334.76, 332.59, 331.42, 330.98, 332.24, 333.68, 
## 334.8, 335.22, 336.47, 337.59, 337.84, 337.72, 336.37, 334.51, 
## 332.6, 332.38, 333.75, 334.78, 336.05, 336.59, 337.79, 338.71, 
## 339.3, 339.12, 337.56, 335.92, 333.75, 333.7, 335.12, 336.56, 
## 337.84, 338.19, 339.91, 340.6, 341.29, 341, 339.39, 337.43, 335.72, 
## 335.84, 336.93, 338.04, 339.06, 340.3, 341.21, 342.33, 342.74, 
## 342.08, 340.32, 338.26, 336.52, 336.68, 338.19, 339.44, 340.57, 
## 341.44, 342.53, 343.39, 343.96, 343.18, 341.88, 339.65, 337.81, 
## 337.69, 339.09, 340.32, 341.2, 342.35, 342.93, 344.77, 345.58, 
## 345.14, 343.81, 342.21, 339.69, 339.82, 340.98, 342.82, 343.52, 
## 344.33, 345.11, 346.88, 347.25, 346.62, 345.22, 343.11, 340.9, 
## 341.18, 342.8, 344.04, 344.79, 345.82, 347.25, 348.17, 348.74, 
## 348.07, 346.38, 344.51, 342.92, 342.62, 344.06, 345.38, 346.11, 
## 346.78, 347.68, 349.37, 350.03, 349.37, 347.76, 345.73, 344.68, 
## 343.99, 345.48, 346.72, 347.84, 348.29, 349.23, 350.8, 351.66, 
## 351.07, 349.33, 347.92, 346.27, 346.18, 347.64, 348.78, 350.25, 
## 351.54, 352.05, 353.41, 354.04, 353.62, 352.22, 350.27, 348.55, 
## 348.72, 349.91, 351.18, 352.6, 352.92, 353.53, 355.26, 355.52, 
## 354.97, 353.75, 351.52, 349.64, 349.83, 351.14, 352.37, 353.5, 
## 354.55, 355.23, 356.04, 357, 356.07, 354.67, 352.76, 350.82, 
## 351.04, 352.69, 354.07, 354.59, 355.63, 357.03, 358.48, 359.22, 
## 358.12, 356.06, 353.92, 352.05, 352.11, 353.64, 354.89, 355.88, 
## 356.63, 357.72, 359.07, 359.58, 359.17, 356.94, 354.92, 352.94, 
## 353.23, 354.09, 355.33, 356.63, 357.1, 358.32, 359.41, 360.23, 
## 359.55, 357.53, 355.48, 353.67, 353.95, 355.3, 356.78, 358.34, 
## 358.89, 359.95, 361.25, 361.67, 360.94, 359.55, 357.49, 355.84, 
## 356, 357.59, 359.05, 359.98, 361.03, 361.66, 363.48, 363.82, 
## 363.3, 361.94, 359.5, 358.11, 357.8, 359.61, 360.74, 362.09, 
## 363.29, 364.06, 364.76, 365.45, 365.01, 363.7, 361.54, 359.51, 
## 359.65, 360.8, 362.38, 363.23, 364.06, 364.61, 366.4, 366.84, 
## 365.68, 364.52, 362.57, 360.24, 360.83, 362.49, 364.34), tsp = c(1959, 
## 1997.91666667, 12), class = "ts")), class = "data.frame", row.names = c(NA, 
## -468L))
```

---


## 9. Base R简单作图



.pull-left[
### 默认的`plot()`函数  

绘制散点图，可用于快速了解数据。
```r 
plot(x = d_CO2$time, y = d_CO2$CO2)
```
]

.pull-right[

&lt;img src="1.2-R_introduction_files/figure-html/unnamed-chunk-48-1.png" width="576" /&gt;
]

---

### 修改为折线图
.pull-left[

```r
plot(x = d_CO2$time, y = d_CO2$CO2, type = "l")
```
]

.pull-right[
&lt;img src="1.2-R_introduction_files/figure-html/unnamed-chunk-49-1.png" width="576" /&gt;
]

---

### 修改颜色设置

.pull-left[
```r 
plot(x = d_CO2$time, y = d_CO2$CO2, type = "l", col = "red")
```
]

.pull-right[
&lt;img src="1.2-R_introduction_files/figure-html/unnamed-chunk-50-1.png" width="576" /&gt;

]

---

### 修改坐标轴名称
.pull-left[

```r 
plot(x = d_CO2$time, y = d_CO2$CO2, type = "l", col = "red", xlab = "Year", ylab = expression(pCO[2]~"(ppm)"))

```
]

.pull-right[
&lt;img src="1.2-R_introduction_files/figure-html/unnamed-chunk-51-1.png" width="576" /&gt;
]

---

## `ggplot`作图

先对`ggplot`绘图有个简单印象，下次课我们深入学习。

.pull-left[
```r
library(ggplot2) #ggplot绘图
ggplot(d_CO2, aes(time, CO2))+
  theme_bw()+
  geom_line(color = "red2")+
  labs(x = "Year",
       y = ~pCO[2]~(ppm))

ggsave("pCO2.png", width=342/90, height=243/90, dpi=600)
```
]

.pull-right[

&lt;img src="pCO2.png" width="410.4" height="291.6" /&gt;
]


---

## 保存图片

### 第一种方法  
首先将图片赋值给变量**`p1`**。 

```r
library(ggplot2)

p1 &lt;- ggplot(mpg, aes(displ, hwy))+
  geom_point()

```
然后调用**`png()`**作图设备作图，并记得随手用**`dev.off()`**关闭作图设备（否则不出图）。变量**`p1`**夹在以上两行代码之间。完成操作后，你就能在工作文件夹里找到名称为“myplot_1.png”的图了。

```r 
png("myplot_1.png", width=359/90*600, height=239/90*600, res=600)
p1
dev.off()
```



---

## 保存图片

### 第二种方法  

由于我们以后大多使用**`ggplot()`**作图，因此可以用**`ggplot2`**程序包中的**`ggsave()`**函数保存当前显示的图片（在RStudio右下面板中）。
```r 
library(ggplot2)
ggplot(mpg, aes(displ, hwy))+
  geom_point()

ggsave("myplot_2.png", width=359/90, height=239/90, dpi=600) #png格式，位图
ggsave("myplot_2.pdf", width=359/90, height=239/90) #pdf格式，矢量图
```
完成以上操作，你就能在工作文件夹里找到名称为“myplot_2.png”“myplot_2.pdf”的图了。

&gt;如何设置合适的**`width`**和**`height`**?  
&gt;需要一些技巧（见下页）和审美能力。

---
## 保存图片 
### 如何设置合适的**`width`**和**`height`**?  
1. 在RStudio的图片窗格中，单击“Zoom”，将绘图缩放到你满意的大小和纵横比;  

2. 在图上单击右键，选择“Copy Image  Address”，将地址粘贴到某处，即可获得地址中的宽度（www）和高度（hhh）信息;

3. 将宽度和高度信息填入`ggsave`，保存图片。注意除以90，转换表示尺寸的像素数和inch单位。 
```r
ggsave("plot.png", width = www/90, height = hhh/90, dpi = 900) 
ggsave("plot.pdf", width = www/90, height = hhh/90)
```


---
## 推荐阅读
Crawley MJ. The R Book. 2nd ed. Chapter 2. Essentials of the R Language.pp 12-136.
(有点枯燥，至少读1/3，读不完的之后的学习过程中还可以再回过头读。)




    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
